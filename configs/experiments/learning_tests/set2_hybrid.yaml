# Hybrid Control Experiment Configuration 

# Base configuration to inherit from
base_config: "configs/base/PiH_base.yaml"


primary:
  ckpt_tracker_path: "/nfs/stak/users/brownhun/hybrid_control_tracker.txt"
  agents_per_break_force: 3
  break_forces: [20]
  max_steps: 3000000
  seed: 42

agent:
  policy_learning_rate: 1.0e-6
  critic_learning_rate: 3.0e-6
  value_update_ratio: 4

environment:
  # Control configuration (will be merged into Isaac Lab's ctrl config)
  # These parameters will be applied to the ExtendedCtrlCfg
  ctrl:
    force_action_bounds: [50.0, 50.0, 50.0]
    torque_action_bounds: [0.5, 0.5, 0.5]
    force_action_threshold: [10.0, 10.0, 10.0]
    torque_action_threshold: [0.1, 0.1, 0.1]
    default_task_force_gains: [0.1, 0.1, 0.1, 0.001, 0.001, 0.001]

  hybrid_task:
    force_active_threshold: 0.1
    torque_active_threshold: 0.01
    good_force_cmd_rew: 0.1
    bad_force_cmd_rew: -0.1
    wrench_norm_scale: 0.01

# Model configuration for hybrid agent
model:
  use_hybrid_agent: true
  critic_output_init_mean: 12  # Higher initial value estimate for complex task

  # Critic architecture (SimBa value network)
  critic:
    n: 5  # Number of SimBa layers
    latent_size: 1024  # Hidden dimension

  # Hybrid agent specific parameters
  hybrid_agent:
    ctrl_torque: false  # Match primary.ctrl_torque
    unit_std_init: true
    pos_init_std: 1.0
    rot_init_std: 1.0
    force_init_std: 1.0

    # Output scaling
    pos_scale: 1.0
    rot_scale: 1.0
    force_scale: 1.0
    torque_scale: 1.0

    # Selection network adjustments
    selection_adjustment_types: ['init_bias']
    init_scale_weights_factor: 0.1
    init_bias: -2.5
    pre_layer_scale_factor: 0.1
    init_scale_last_layer: true
    init_layer_scale: 1.0
    uniform_sampling_rate: 0.0

# Enable hybrid control wrapper and related systems
wrappers:

  # Enable hybrid control wrapper
  hybrid_control:
    enabled: true
    # ctrl_torque will be computed from primary config automatically
    reward_type: "none"  # Simple reward structure to start

# Experiment metadata
experiment:
  name: "value_test_hybrid"
  tags: []
  group: "value_test_hybrid"
  wandb_project: "hyper_tests"
